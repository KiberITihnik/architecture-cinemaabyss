### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ¬´–ö–∞–∫ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å¬ª (To-Be) –¥–ª—è ¬´–ö–∏–Ω–æ–±–µ–∑–¥–Ω—ã¬ª

–Ø —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–ª **—Ü–µ–ª–µ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É** –¥–ª—è ¬´–ö–∏–Ω–æ–±–µ–∑–¥–Ω—ã¬ª –≤ –Ω–æ—Ç–∞—Ü–∏–∏ **C4 Container Diagram**. –†–µ—à–µ–Ω–∏–µ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞:

- **–î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—é –º–æ–Ω–æ–ª–∏—Ç–∞ –ø–æ –¥–æ–º–µ–Ω–∞–º** —Å –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤  
- **–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ Kubernetes** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Helm  
- **–°–æ–±—ã—Ç–∏–π–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—é** —á–µ—Ä–µ–∑ Kafka (MVP)  
- **–ú–∏–≥—Ä–∞—Ü–∏—é –±–µ–∑ –ø—Ä–æ—Å—Ç–æ—è**  
- **–ï–¥–∏–Ω—ã–π API-—à–ª—é–∑** –∫–∞–∫ —Ç–æ—á–∫—É –≤—Ö–æ–¥–∞ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤  

---

### üìä –î–∏–∞–≥—Ä–∞–º–º–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ C4 (–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ¬´–ö–∞–∫ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å¬ª)
[–î–∏–∞–≥—Ä–∞–º–º–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ C4"](/tasks/task1/to_be.puml)  

#### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
| **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä**               | **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è**       | **–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**                                                                 | **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**   |
|-----------------------------|----------------------|----------------------------------------------------------------------------------|-------------------|
| **API Gateway**             | Kong/Nginx + Go      | –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤; –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤ | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç       |
| **User Service**            | Go                   | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, –ø—Ä–æ—Ñ–∏–ª–∏, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ | PostgreSQL        |
| **Metadata Service**        | Go                   | –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∏–ª—å–º–æ–≤ (–∂–∞–Ω—Ä—ã, –∞–∫—Ç—ë—Ä—ã, –æ—Ü–µ–Ω–∫–∏), –∫–∞—Ç–∞–ª–æ–≥ –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –ø–æ–∏—Å–∫              | PostgreSQL        |
| **Payment Service**         | Go                   | –ü–ª–∞—Ç–µ–∂–∏, –ø–æ–¥–ø–∏—Å–∫–∏, —Å–∫–∏–¥–∫–∏, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–ª–∞—Ç—ë–∂–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏                     | PostgreSQL        |
| **Video Service**           | Go                   | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–µ–æ, –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏            | PostgreSQL + S3   |
| **Recommendation Adapter**  | Go                   | –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Å–æ–±—ã—Ç–∏—è –¥–ª—è –≤–Ω–µ—à–Ω–µ–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã (Kafka ‚Üí REST)         | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç       |
| **Kafka Cluster**           | Kafka + Zookeeper    | –®–∏–Ω–∞ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è (–æ—Å–Ω–æ–≤–∞ MVP)                       | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç       |

#### –í–Ω–µ—à–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã:
- **–ü–ª–∞—Ç—ë–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã** (–Ω–∞–ø—Ä–∏–º–µ—Ä, Stripe) ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π REST  
- **–û–Ω–ª–∞–π–Ω-–∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä—ã** (–Ω–∞–ø—Ä–∏–º–µ—Ä, Netflix) ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π REST  
- **S3** ‚Äî –æ–±—ä–µ–∫—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –≤–∏–¥–µ–æ  
- **–í–Ω–µ—à–Ω—è—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞** ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —á–µ—Ä–µ–∑ Kafka  

---

### üîë –ö–ª—é—á–µ–≤—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

#### 1. **–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –ø–æ –¥–æ–º–µ–Ω–∞–º**
- **Metadata Service** –≤—ã–Ω–µ—Å–µ–Ω –ø–µ—Ä–≤—ã–º (–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ü–µ–ª—è–º–∏ –±–∏–∑–Ω–µ—Å–∞):
  - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∏–ª—å–º–æ–≤ (–∂–∞–Ω—Ä—ã, –∞–∫—Ç—ë—Ä—ã, –æ—Ü–µ–Ω–∫–∏)
  - –ò–º–µ–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Å—Ö–µ–º—É –ë–î (–æ—Ç–¥–µ–ª—ë–Ω –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –ø–ª–∞—Ç–µ–∂–µ–π)
  - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
- **–û—Å—Ç–∞–ª—å–Ω—ã–µ –¥–æ–º–µ–Ω—ã**:
  - `User Service`: —É—á—ë—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, –ø—Ä–æ—Ñ–∏–ª–∏, –ø—Ä–æ–≥—Ä–∞–º–º—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏
  - `Payment Service`: –ø–æ–¥–ø–∏—Å–∫–∏, —Å–∫–∏–¥–∫–∏, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π
  - `Video Service`: –∫–∞—Ç–∞–ª–æ–≥ –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏

#### 2. **–°—Ç—Ä–∞—Ç–µ–≥–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è**
| **–¢–∏–ø**          | **–ú–µ—Ö–∞–Ω–∏–∑–º**       | **–°—Ü–µ–Ω–∞—Ä–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**                         | **–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ**                                                     |
|--------------------|---------------------|--------------------------------------------------|-----------------------------------------------------------------------|
| **–°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π**    | REST/HTTP           | –í—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –æ–ø–ª–∞—Ç–∞, –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤–∏–¥–µ–æ | –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç –¥–ª—è –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è                |
| **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π**   | Kafka (MVP)         | –û—Ü–µ–Ω–∫–∏ —Ñ–∏–ª—å–º–æ–≤, –∏—Å—Ç–æ—Ä–∏—è –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π | –†–∞–∑–≤—è–∑—ã–≤–∞–µ—Ç —Å–µ—Ä–≤–∏—Å—ã; –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å |
| **–ì–∏–±—Ä–∏–¥–Ω—ã–π**     | –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ API Gateway | –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫–ª–∏–µ–Ω—Ç–æ–≤                          | –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞; –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–¢–í/–º–æ–±–∏–ª—å–Ω—ã–µ)    |

#### 3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Kubernetes –∏ CI/CD**
- **Helm-—á–∞—Ä—Ç—ã** –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (–≤–∫–ª—é—á–∞—è Kafka)
- **CI/CD-–ø–∞–π–ø–ª–∞–π–Ω**:
  - –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (—é–Ω–∏—Ç, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ, end-to-end)
  - Canary-—Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –±–µ–∑ –ø—Ä–æ—Å—Ç–æ—è
  - GitOps-–ø–æ–¥—Ö–æ–¥ (ArgoCD)
- **–ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å**:
  - Prometheus + Grafana –¥–ª—è –º–µ—Ç—Ä–∏–∫
  - Jaeger –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ —Ç—Ä–µ–π—Å–∏–Ω–≥–∞
  - Loki –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –ª–æ–≥–æ–≤

#### 4. **–ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏ –±–µ–∑ –ø—Ä–æ—Å—Ç–æ—è**
1. **–≠—Ç–∞–ø 1**: –ó–∞–ø—É—Å–∫ API Gateway –∏ Metadata Service –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å –º–æ–Ω–æ–ª–∏—Ç–æ–º
   - Metadata Service –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç *–Ω–æ–≤—ã–µ* –∑–∞–ø—Ä–æ—Å—ã; –º–æ–Ω–æ–ª–∏—Ç –æ—Å—Ç–∞—ë—Ç—Å—è –æ—Å–Ω–æ–≤–Ω—ã–º
   - –î–≤–æ–π–Ω–∞—è –∑–∞–ø–∏—Å—å –≤ –æ–±–µ —Å–∏—Å—Ç–µ–º—ã –≤–æ –≤—Ä–µ–º—è –ø–µ—Ä–µ—Ö–æ–¥–∞
2. **–≠—Ç–∞–ø 2**: –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π –ø–µ—Ä–µ–Ω–æ—Å —Ç—Ä–∞—Ñ–∏–∫–∞ –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ feature flags –¥–ª—è –ø–æ—ç—Ç–∞–ø–Ω–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫ (–æ—à–∏–±–∫–∏, –∑–∞–¥–µ—Ä–∂–∫–∏)
3. **–≠—Ç–∞–ø 3**: –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –º–æ–Ω–æ–ª–∏—Ç–∞
   - –ù–∞—á–∏–Ω–∞—è —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö, –∑–∞—Ç–µ–º –ø–ª–∞—Ç–µ–∂–∏, –∑–∞—Ç–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
   - –ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –º–µ–Ω–µ–µ —á–µ–º –∑–∞ 2 –Ω–µ–¥–µ–ª–∏ (–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ü–µ–ª—è–º–∏ –±–∏–∑–Ω–µ—Å–∞)

---

### üìå –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —Ç–∞–∫?
1. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**  
   –ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Video Service –≤ —á–∞—Å—ã –ø–∏–∫)
2. **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å**  
   Kafka –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å–±–æ—è—Ö; circuit breakers –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—Ç –∫–∞—Å–∫–∞–¥–Ω—ã–µ –æ—Ç–∫–∞–∑—ã
3. **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –±–∏–∑–Ω–µ—Å-—Ü–µ–ª—è–º**  
   - Metadata Service –≤—ã–Ω–µ—Å–µ–Ω –ø–µ—Ä–≤—ã–º (–∫–∞–∫ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
   - MVP –Ω–∞ Kafka –∑–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç –æ—Å–Ω–æ–≤—É –¥–ª—è –±—É–¥—É—â–∏—Ö —Å–æ–±—ã—Ç–∏–π–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏)
4. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç**  
   API Gateway –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç—ã –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–¢–í vs. –º–æ–±–∏–ª—å–Ω—ã–µ)

---
